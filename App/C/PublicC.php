<?php
namespace App\C;
/**
 *         ▂▃╬▄▄▃▂▁▁
 *  ●●●█〓██████████████▇▇▇▅▅▅▅▅▅▅▅▅▇▅▅          BUG
 *  ▄▅████☆RED █ WOLF☆███▄▄▃▂
 *  █████████████████████████████
 *  ◥⊙▲⊙▲⊙▲⊙▲⊙▲⊙▲⊙▲⊙▲⊙◤
 *
 * 客户端访客类
 * @author 路漫漫
 * @link ahmerry@qq.com
 * @since
 * v2016/12/9 初版
 */
use App\M\EventsM;
use App\M\JobsM;
use App\M\MapsM;
use App\M\TilesetsM;
use App\M\UsersM;
use Base\Tool\Vcode;
use Base\Tool\Page;

class PublicC extends AppC {

    public function index($param){
        return ResultFormat($param);
    }

    public function test(){
        $mapData = json_decode('{"countX":15,"countY":15,"data":[[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,22,22,22,22,22,1,1,1,1,1],[1,1,1,1,4,4,4,4,4,4,4,1,1,1,1],[1,1,1,1,4,4,4,4,4,4,4,1,1,1,1],[1,1,1,1,4,4,4,4,4,4,4,1,1,1,1],[1,1,1,1,4,4,4,4,4,4,4,1,1,1,1],[1,1,1,1,4,4,4,4,4,4,4,1,1,1,1],[1,1,1,1,4,4,4,4,4,4,4,1,1,1,1],[1,1,1,1,4,4,4,4,4,4,4,1,1,1,1],[1,1,1,1,4,4,4,4,4,4,4,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,360,361,171,362,362,362,171,363,364,0,0,0],[0,0,0,370,371,181,420,372,420,181,373,374,0,0,0],[0,0,0,370,37,382,430,382,430,382,37,384,0,0,0],[0,0,0,370,443,444,445,0,430,0,42,384,0,0,0],[0,0,0,370,453,454,455,0,440,444,442,384,0,0,0],[0,0,0,370,0,0,0,0,450,454,452,384,0,0,0],[0,0,0,370,151,150,151,0,0,0,42,384,0,0,0],[0,0,0,370,0,0,0,0,0,0,42,384,0,0,0],[0,0,0,390,395,395,391,0,392,395,393,394,0,0,0],[0,0,0,400,405,405,401,0,402,405,403,404,0,0,0],[0,0,0,410,415,415,411,0,412,415,413,414,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,102,99,0,100,0,0,0,0,0,0],[0,0,0,0,0,0,99,0,100,101,0,0,0,0,0],[0,0,0,0,99,99,99,0,100,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,100,100,100,0,0,0,0],[0,0,0,0,105,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,110,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]]}',true);
        $mapData['tileSetData'] = json_decode('[[0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,0,1,1,1,2,2,0,0,1,0,1,1,1,1,1,0,0,0,0,1,1,1,1,1,0,1,1,1,2,1,1,2,2,2,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,0,1,2,2,2,0,0,2,2,2,2,1,1,1,2,2,1,1,1,1,1,0,1,1,1,0,1,1,0,2,2,2,1,0,2,2,2,2,1,1,1,0,0,1,1,1,1,1,0,1,0,0,1,1,1,1,0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]',true);
        echo ResultFormat($mapData);
    }
    /**
     * 游戏职业获取
     */
    public function jobs(){
        $job = new JobsM();
        echo ResultFormat($job->getCurr());
    }

    /**
     * 登录
     */
    public function login(){
//        if (Vcode::check($_POST['vcode'])){
            $u = new UsersM();
            echo ResultFormat($u->login());
//        }else{
//            echo ResultFormat(['code'=>-1,'msg'=>'验证码错误']);
//        }
    }

    /**
     * 注册
     */
    public function register(){
//        if (Vcode::check($_POST['vcode'])){
            $u = new UsersM();
            echo ResultFormat($u->register());
//        }else{
//            echo ResultFormat(['code'=>-1,'msg'=>'验证码错误']);
//        }
    }

    /**
     * 退出登录 ,清除 session
     */
    public function logout(){
        unset($_SESSION);
        unset($_COOKIE);
    }

    /**
     * 分页功能
     */
    public function page() {
        $page = new Page(345);
        print_r($page->show());
    }

    /**
     * 验证码功能
     */
    public function vcode() {
        $vcode = new Vcode();
        $vcode->scode();
    }

}